!function(){function a(a){var b="";c[a.charAt(0)]&&(b=a.charAt(0),a=a.substring(1));var e="",f="",g=!0,h=!1,i=!1;"+"==b?g=!1:"."==b?(f=".",e="."):"/"==b?(f="/",e="/"):"#"==b?(f="#",g=!1):";"==b?(f=";",e=";",h=!0,i=!0):"?"==b?(f="?",e="&",h=!0):"&"==b&&(f="&",e="&",h=!0);for(var j=[],k=a.split(","),l=[],m={},n=0;n<k.length;n++){var o=k[n],p=null;if(-1!=o.indexOf(":")){var q=o.split(":");o=q[0],p=parseInt(q[1])}for(var r={};d[o.charAt(o.length-1)];)r[o.charAt(o.length-1)]=!0,o=o.substring(0,o.length-1);var s={truncate:p,name:o,suffices:r};l.push(s),m[o]=s,j.push(o)}var t=function(a){for(var b=f,c=0;c<l.length;c++){var d=l[c];c>0&&(b+=e||",");var j=a(d.name);if(Array.isArray(j)){h&&(b+=d.name+"=");for(var k=0;k<j.length;k++)k>0&&(b+=d.suffices["*"]?e||",":",",d.suffices["*"]&&h&&(b+=d.name+"=")),b+=g?encodeURIComponent(j[k]).replace(/!/g,"%21"):encodeURI(j[k]).replace(/%25/g,"%")}else if("object"==typeof j){h&&!d.suffices["*"]&&(b+=d.name+"=");var m=!0;for(var n in j)m||(b+=d.suffices["*"]?e||",":","),m=!1,b+=g?encodeURIComponent(n).replace(/!/g,"%21"):encodeURI(n).replace(/%25/g,"%"),b+=d.suffices["*"]?"=":",",b+=g?encodeURIComponent(j[n]).replace(/!/g,"%21"):encodeURI(j[n]).replace(/%25/g,"%")}else h&&(b+=d.name,i&&""==j||(b+="=")),null!=d.truncate&&(j=j.substring(0,d.truncate)),b+=g?encodeURIComponent(j).replace(/!/g,"%21"):encodeURI(j).replace(/%25/g,"%")}return b},u=function(a,b){if(f&&a.substring(0,f.length)==f&&(a=a.substring(f.length)),1==l.length&&l[0].suffices["*"]){for(var c=l[0],d=c.name,i=c.suffices["*"]?a.split(e||","):[a],j=g&&-1!=a.indexOf("="),k=1;k<i.length;k++){var a=i[k];j&&-1==a.indexOf("=")&&(i[k-1]+=(e||",")+a,i.splice(k,1),k--)}for(var k=0;k<i.length;k++){var a=i[k];g&&-1!=a.indexOf("=")&&(j=!0);for(var n=a.split(","),o=0;o<n.length;o++)g&&(n[o]=decodeURIComponent(n[o]));i[k]=1==n.length?n[0]:n}if(h||j){for(var p=b[d]||{},o=0;o<i.length;o++){var q=a;if("string"==typeof i[o]){var a=i[o],r=a.split("=",1)[0],a=a.substring(r.length+1);q=a}else{var a=i[o][0],r=a.split("=",1)[0],a=a.substring(r.length+1);i[o][0]=a,q=i[o]}void 0!==p[r]?Array.isArray(p[r])?p[r].push(q):p[r]=[p[r],q]:p[r]=q}b[d]=1==Object.keys(p).length&&void 0!==p[d]?p[d]:p}else b[d]=void 0!==b[d]?Array.isArray(b[d])?b[d].concat(i):[b[d]].concat(i):1!=i.length||c.suffices["*"]?i:i[0]}else{for(var i=1==l.length?[a]:a.split(e||","),s={},k=0;k<i.length;k++){for(var t=0;t<l.length-1&&k>t&&!l[t].suffices["*"];t++);if(o!=k){for(var u=l.length-1;u>0&&l.length-u<i.length-k&&!l[u].suffices["*"];u--);s[k]=l.length-u!=i.length-k?t:u}else s[k]=k}for(var k=0;k<i.length;k++){var a=i[k],n=a.split(",");if(h){var a=n[0],d=a.split("=",1)[0],a=a.substring(d.length+1);n[0]=a;var c=m[d]||l[0]}else var c=l[s[k]],d=c.name;for(var o=0;o<n.length;o++)g&&(n[o]=decodeURIComponent(n[o]));b[d]=(h||c.suffices["*"])&&void 0!==b[d]?Array.isArray(b[d])?b[d].concat(n):[b[d]].concat(n):1!=n.length||c.suffices["*"]?n:n[0]}}};return t.varNames=j,{substitution:t,unSubstitution:u}}function b(c){if(!(this instanceof b))return new b(c);for(var d=c.split("{"),e=[d.shift()],f=[],g=[],h=[];d.length>0;){var i=d.shift(),j=i.split("}")[0],k=i.substring(j.length+1),l=a(j);f.push(l.substitution),g.push(l.unSubstitution),e.push(k),h=h.concat(l.substitution.varNames)}this.fill=function(a){for(var b=e[0],c=0;c<f.length;c++){var d=f[c];b+=d(a),b+=e[c+1]}return b},this.fromUri=function(a){for(var b={},c=0;c<e.length;c++){var d=e[c];if(a.substring(0,d.length)!=d)return void 0;if(a=a.substring(d.length),c>=e.length-1){if(""==a)break;return void 0}var f=e[c+1];if(f){var h=a.indexOf(f),i=a.substring(0,h);a=a.substring(h)}else{var i=a;a=""}g[c](i,b)}return b},this.varNames=h}var c={"+":!0,"#":!0,".":!0,"/":!0,";":!0,"?":!0,"&":!0},d={"*":!0};b.prototype={fillFromObject:function(a){return this.fill(function(b){return a[b]})}},"undefined"!=typeof module&&(module.exports=b),this&&(this.UriTemplate=b)}.call(this);